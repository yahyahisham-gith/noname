-- admin-hub-V1
-- VERSION: 1.9.8 (DOOR FIX + CACTUS)
-- Universal + "The Door" Specialized Logic

-- [1] CLEANUP
if _G.HubRunning then 
    _G.HubStop = true 
    local old = game.CoreGui:FindFirstChild("AdminHubV1") or game.Players.LocalPlayer.PlayerGui:FindFirstChild("AdminHubV1")
    if old then old:Destroy() end
    task.wait(0.3) 
end
_G.HubRunning, _G.HubStop = true, false

local Player = game.Players.LocalPlayer
local UIS, RunService = game:GetService("UserInputService"), game:GetService("RunService")

-- [2] ENHANCED DOOR LOGIC
local function ForceCloseAllDoors()
    for _, v in pairs(workspace:GetDescendants()) do
        -- Searches for anything containing "Door" or "Gate"
        if (v.Name:lower():find("door") or v.Name:lower():find("gate")) and v:IsA("BasePart") then
            v.CanCollide = true
            v.Transparency = 0
            
            -- Trigger any proximity prompts to 'Force' the game to think it's closed
            local prompt = v:FindFirstChildWhichIsA("ProximityPrompt", true)
            if prompt then
                fireproximityprompt(prompt)
            end
            
            -- Kill any 'Open' values if they exist
            local openVal = v:FindFirstChild("Open") or v:FindFirstChild("Opened")
            if openVal and openVal:IsA("BoolValue") then
                openVal.Value = false
            end
        end
    end
end

-- [3] UI CONSTRUCTION
local ScreenGui = Instance.new("ScreenGui")
pcall(function() ScreenGui.Parent = game:GetService("CoreGui") end)
if not ScreenGui.Parent then ScreenGui.Parent = Player.PlayerGui end
ScreenGui.Name = "AdminHubV1"

local DragFrame = Instance.new("Frame", ScreenGui)
DragFrame.Size = UDim2.new(0, 250, 0, 40); DragFrame.Position = UDim2.new(0.5, -125, 0.2, 0)
DragFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35); DragFrame.Active = true; DragFrame.Draggable = true 
Instance.new("UICorner", DragFrame)

local Title = Instance.new("TextLabel", DragFrame)
Title.Size = UDim2.new(1, 0, 1, 0); Title.Text = "MASTER HUB V1.9.8"; Title.TextColor3 = Color3.new(1,1,1)
Title.BackgroundTransparency = 1; Title.Font = Enum.Font.GothamBold

local Main = Instance.new("Frame", DragFrame)
Main.Size = UDim2.new(1, 0, 0, 480); Main.Position = UDim2.new(0, 0, 1, 5)
Main.BackgroundColor3 = Color3.fromRGB(20, 20, 20); Instance.new("UICorner", Main)

local Scroll = Instance.new("ScrollingFrame", Main)
Scroll.Size = UDim2.new(1, -10, 1, -10); Scroll.Position = UDim2.new(0, 5, 0, 5)
Scroll.BackgroundTransparency = 1; Scroll.CanvasSize = UDim2.new(0, 0, 8, 0); Scroll.ScrollBarThickness = 2
local UIList = Instance.new("UIListLayout", Scroll); UIList.Padding = UDim.new(0, 8); UIList.HorizontalAlignment = Enum.HorizontalAlignment.Center

local function NewBtn(text, color)
    local b = Instance.new("TextButton", Scroll)
    b.Size = UDim2.new(0.9, 0, 0, 35); b.Text = text; b.BackgroundColor3 = color; b.TextColor3 = Color3.new(1,1,1)
    Instance.new("UICorner", b); return b
end

-- --- THE DOOR FIXES ---
NewBtn("FORCE CLOSE DOORS (FIXED)", Color3.fromRGB(180, 0, 0)).MouseButton1Click:Connect(ForceCloseAllDoors)

NewBtn("SUMMON DESERT CACTUS", Color3.fromRGB(45, 120, 45)).MouseButton1Click:Connect(function()
    local cactus = nil
    for _, v in pairs(game:GetDescendants()) do
        if v:IsA("Model") and (v.Name:lower():find("cactus") or v.Name:lower():find("spike")) then
            cactus = v; break
        end
    end
    if cactus then
        local c = cactus:Clone(); c.Parent = workspace
        c:MoveTo(Player.Character.HumanoidRootPart.Position + (Player.Character.HumanoidRootPart.CFrame.LookVector * 5))
    end
end)

-- --- BUBBLE CHAT (FOR MUTE) ---
local BubbleIn = Instance.new("TextBox", Scroll)
BubbleIn.Size = UDim2.new(0.9, 0, 0, 35); BubbleIn.PlaceholderText = "Bubble Msg..."; BubbleIn.BackgroundColor3 = Color3.fromRGB(45, 45, 45); BubbleIn.TextColor3 = Color3.new(1,1,1); Instance.new("UICorner", BubbleIn)
NewBtn("SEND BUBBLE", Color3.fromRGB(120, 0, 180)).MouseButton1Click:Connect(function()
    if BubbleIn.Text ~= "" and Player.Character:FindFirstChild("Head") then
        local b = Instance.new("BillboardGui", Player.Character.Head); b.Size = UDim2.new(0, 250, 0, 50); b.ExtentsOffset = Vector3.new(0, 3, 0)
        local f = Instance.new("Frame", b); f.Size = UDim2.new(1,0,1,0); f.BackgroundColor3 = Color3.new(1,1,1); Instance.new("UICorner", f)
        local l = Instance.new("TextLabel", f); l.Size = UDim2.new(1,0,1,0); l.Text = BubbleIn.Text; l.TextScaled = true; l.BackgroundTransparency = 1
        task.delay(5, function() b:Destroy() end); BubbleIn.Text = ""
    end
end)

-- --- HUB CONTROLS ---
NewBtn("CLOSE HUB (HIDE)", Color3.fromRGB(60, 60, 60)).MouseButton1Click:Connect(function() ScreenGui.Enabled = false end)
NewBtn("FORCE CLOSE HUB (KILL)", Color3.fromRGB(170, 0, 0)).MouseButton1Click:Connect(function()
    _G.HubStop, _G.HubRunning = true, false; ScreenGui:Destroy()
end)
