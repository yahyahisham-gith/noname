-- admin-hub-V1
-- Universal Admin Hub (Toggle Fly + Noclip + Camera Relative)
-- Compatibility: Xeno Executor

-- [1] KILLSWITCH & CLEANUP
-- Stops any previous instances of the script to prevent lag or double-GUIs
if _G.HubRunning then 
    _G.HubStop = true 
    -- Search CoreGui and PlayerGui for old versions
    local oldGui = game.CoreGui:FindFirstChild("AdminHubV1") or game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("AdminHubV1")
    if oldGui then oldGui:Destroy() end
    task.wait(0.3) 
end

_G.HubRunning = true
_G.HubStop = false
_G.Flying = false 

local Player = game:GetService("Players").LocalPlayer
local Camera = workspace.CurrentCamera
local RunService = game:GetService("RunService")

-- [2] TOGGLE FLY & NOCLIP LOGIC
local function ToggleFly(button)
    _G.Flying = not _G.Flying
    
    local Character = Player.Character
    if not Character then return end
    local Root = Character:WaitForChild("HumanoidRootPart")
    local Humanoid = Character:WaitForChild("Humanoid")

    if _G.Flying then
        -- START FLYING
        button.Text = "Fly: ON"
        button.BackgroundColor3 = Color3.fromRGB(0, 200, 100)
        
        -- Body Objects for Physics Manipulation
        local BV = Instance.new("BodyVelocity", Root)
        local BG = Instance.new("BodyGyro", Root)
        BV.Name = "HubFlyBV"
        BG.Name = "HubFlyBG"
        
        BV.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
        BG.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
        BG.P = 15000
        
        local FlySpeed = 60

        -- Main Flight & Noclip Loop
        task.spawn(function()
            while _G.Flying and not _G.HubStop and Character and Character.Parent do
                -- Rotation follows camera
                BG.CFrame = Camera.CFrame
                
                -- Direction handling
                local MoveDirection = Humanoid.MoveDirection
                if MoveDirection.Magnitude > 0 then
                    -- Camera Relative: Fly in direction of crosshair
                    BV.Velocity = Camera.CFrame.LookVector * (MoveDirection.Magnitude * FlySpeed)
                else
                    BV.Velocity = Vector3.new(0, 0, 0)
                end
                
                -- NOCLIP COMPONENT
                -- Setting state to 11 (StrafingNoPhysics) allows passing through parts
                Humanoid:ChangeState(11)
                
                RunService.RenderStepped:Wait()
            end
            
            -- CLEANUP: Reset physics and remove forces when stopped
            if BV then BV:Destroy() end
            if BG then BG:Destroy() end
            if Humanoid then Humanoid:ChangeState(8) end -- Return to 'FallingDown' to reset physics
        end)
    else
        -- STOP FLYING
        button.Text = "Fly: OFF"
        button.BackgroundColor3 = Color3.fromRGB(0, 120, 200)
    end
end

-- [3] UI CREATION
-- Using CoreGui so it doesn't get deleted if the player resets or changes scenes
local ScreenGui = Instance.new("ScreenGui")
pcall(function()
    ScreenGui.Parent = game:GetService("CoreGui")
end)
if not ScreenGui.Parent then ScreenGui.Parent = Player:WaitForChild("PlayerGui") end

ScreenGui.Name = "AdminHubV1"
ScreenGui.ResetOnSpawn = false

local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0, 200, 0, 150)
Main.Position = UDim2.new(0.5, -100, 0.4, -75)
Main.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
Main.Active = true
Main.Draggable = true -- Allows you to move the menu
Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 10)

local Title = Instance.new("TextLabel", Main)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Text = "ADMIN HUB V1"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.GothamBold
Title.TextSize = 14

-- Button Helper Function
local function CreateButton(text, pos, color, func)
    local btn = Instance.new("TextButton", Main)
    btn.Size = UDim2.new(0.9, 0, 0, 35)
    btn.Position = pos
    btn.Text = text
    btn.BackgroundColor3 = color
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 14
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)
    
    btn.MouseButton1Click:Connect(function() 
        func(btn) 
    end)
    return btn
end

-- [4] BUTTONS
CreateButton("Fly: OFF", UDim2.new(0.05, 0, 0.3, 0), Color3.fromRGB(0, 120, 200), ToggleFly)

CreateButton("Speed 100", UDim2.new(0.05, 0, 0.6, 0), Color3.fromRGB(150, 100, 0), function()
    if Player.Character and Player.Character:FindFirstChild("Humanoid") then 
        Player.Character.Humanoid.WalkSpeed = 100 
    end
end)

CreateButton("Close Hub", UDim2.new(0.05, 0, 0.85, 0), Color3.fromRGB(150, 0, 0), function()
    _G.HubStop = true
    _G.Flying = false
    ScreenGui:Destroy()
end)

print("Admin Hub V1 Loaded. Camera-relative Fly + Noclip Active.")
